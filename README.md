Metrics for <STM> Labs
=============================
Данный проект является серверным приложением, который принимает и сохраняет метрики, которые ему присылают используя Rest API.

Выполнено: 
1.	Создание инфраструктуры приложения с помощью Spring Boot
2.	Создание ООП и реляционной моделей данных 
3.	Реализация маппинга ООП модели на реляционную модель. Реализация уровня доступа к данным и сервисного уровня для получения и сохранения метрик.
4.	Реализация REST API, использующего разработанные выше сервисы.
5.	Реализация junit тестов, покрывающих сервисный уровень для тестирования функционала получения, сохранения и валидации запросов.

INSTALLATION
------------

Распакуйте архив в директорию на вашем ПК. Убедитесь что после распаковки архива вы видите следующие файлы и каталоги.

      metrics/               Корневой узел проекта
      README.md				 Краткое описание проекта
     

QUICK START
-----------
Перед запуском приложения убедитесь что на вашем компьютере установлен Maven.
Подробнее об установке Maven ...

Для успешного запуска приложение необходимо наличие установленного сервера PostgreSQl 9.3 и выше
	host = localhost
	port = 5432
	user = root
	userPass = root
	
Так же необходимо наличие созданной базы данных с именем METRICS_DB:	
	owner:root 
	pass:root
Если вы хотите создать базу данных со своим именем или использовать другой сервер то,
адрес сервера, имя базы данных и данные пользователя можно поменять в файле application.properties расположенном по следущему пути:
		/metrics/src/main/resources/application.properties)
		
Порядок запуска приложения:

	1.Запустите среду разработки IntelliJ IDEA.
	2.Перейдите во вкладку File -> Open -> укажите путь к каталогу "metrics/"
	3.Откроется проект.
	4.Дождитесь загрузки необходимых для работы приложения библиотек.
	  Загрузка осуществляется автоматически благодаря Maven 
	5.В дереве проекта перейдите по следующему пути
		metrics/src/main/resources/db/ и найдите файл initDB.sql
		Выделите данный файл и запустите файл на исполнение путем нажатия на сочетание Ctrl+Shift+F10 или ПКМ->Run
		
		При успешном выполнении скрипта, в базе данных METRIC_DB в схеме public должны появиться следующие таблцицы:
			- attributes
			- cpu_metrics
			- hdd_metrics
			- memory-metrics
			- ssd_metrics
			- task_metrics

	6.Запустите проект Shift+F10
	
	NOTE: для успешного запуска проекта необходимо чтобы порт :8080 был не занят сторонним приложением.
	Для просмотра используемых портов на ОС Windows выполните в командной строке команду  netstat -ano 

TESTING
-----------
	Для тестирования функционала приложения разработаны Unit-тесты на получение
		POST запросов с набором метрик для их сохранения в базу данных
		GET запросов с выборками метрик,
	
Автоматизированное тестирование:
	
	1. Тестирование POST запроса с набором метрик
	В дереве проекта перейдите по следующему пути
		metrics/src/test/java/api/v1/metrics/postTest/
		Откройте файл MetricsPostTest.java запустите на исполнение путем нажатия на сочетание Ctrl+Shift+F10 или ПКМ->Run

		При успешном выполнении теста в шапке командной строки IntelliJ IDEA появится надпись "1 test passed" и в базу данных будет добавлено по 1 новой записи для каждой метрики.
		Повторите данную процедуру 3 раза для добавления 3х записей по каждой метрике для дальнейшего тестирования GET запросов.
		
	2. Тестирование GET запросов	
	В дереве проекта перейдите по следующему пути
		metrics/src/test/java/api/v1/metrics/getTest/
		Откройте файл MetricsGetTest.java запустите на исполнение путем нажатия на сочетание Ctrl+Shift+F10 или ПКМ->Run

		При успешном выполнении теста в шапке командной строки IntelliJ IDEA появится надпись "All 22 test passed".
		
		Данные тесты покрывают выполнение следующих требований:
		
		1. Получение GET запроса http://localhost:8080/api/v1/metrics/get/{name}/{count}
			
				name - тип метрики (cpu, hdd, sdd, memory, taskCount);
				count - число получаемых записей.
				
			Возвращает указанное число записей указанного типа метрик. 
			
		2. Получение GET запроса http://localhost:8080/api/v1/metrics/get/{name}		
		
				name - тип метрики (cpu, hdd, sdd, memory, taskCount)
				Возвращает  последние 3 записи соответсвующего типа.
				
		3. Получение GET запроса http://localhost:8080/api/v1/metrics/get/all/{count}			
				
				count - число получаемых записей.
				Возвращает указанное число записей всех тиипов метрик. 
				
			Возвращает указанное число записей указанного типа метрик. 
			
		4. Получение GET запроса http://localhost:8080/api/v1/metrics/get/all		
		
				Возвращает  последние 3 записи всех типов метрик.
				
		5.	Получение ошибки 400 Bad_Request в случаях если:		
				имя метрики не указано;
				указанной метрики не существует.
				
				
WHAT'S NEXT
-----------

Вы можете просмотреть список всех метрик в базе данных по ссылке:
 http://localhost:8080/


